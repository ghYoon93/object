- **명령-쿼리 분리(Command-Query Separation) 원칙**
  - 퍼블릭 인터페이스에 오퍼레이션을 정의할 때 참고할 수 있는 지침을 제공

- 명령-쿼리 분리 원칙
  - 루틴(routine)
    - 어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈
    - 프로시저(procedure)
      - 정해진 절차에 따라 내부의 상태를 변경하는 루틴의 한 종류 -> 값을 반환할 수 없다.
      - 명령이라고도 함
    - 함수(function)
      - 어떤 절차에 따라 필요한 값을 계산해서 반환하는 루틴의 한 종류 -> 부수효과를 발생시킬 수 없다.
      - 쿼리라고도 함
- 질문이 답변을 수정해서는 안 된다
- 명령과 쿼리를 분리해서 얻게 되는 장점은 무엇일까?

## 반복 일정의 명령과 쿼리 분리하기
- 일정관리
  - 주기적으로 반복되는 일정을 쉽고 간편하게 관리할 수 있는 방법
  - 도메인
    - 이벤트(event)와 반복 일정(recurring schedule)
    - 이벤트
      - 특정 일자에 실제로 발생하는 사건
      - 반복 일정을 만족하는 특정 일자와 시간에 발생하는 사건
    - 일정
      - 일주일 단위로 돌아오는 특정 시간 간격에 발생하는 사건 전체를 포괄적으로 지칭하는 용어
- `isSatisfied` 메서드는 겉으로는 쿼리처럼 보이지만 내부적으로는 명령을 일부 포함하고 있다.
  - 명령과 쿼리를 명확하게 분리하자

## 명령-쿼리 분리와 참조 투명성
- 명령과 쿼리를 엄격하게 분류하면 객체의 부수효과를 제어하기가 수월해진다.
- **참조 투명성(referential transparency)**
  - 입력이 동일하면 결과 역시 항상 동일
- 컴퓨터의 세계와 수학의 세계를 나누는 가장 큰 특징
  - 부수효과의 존재 유무
  - 부수효과를 발생시키는 두 가지 대표적인 문법
    - 대입문
    - 함수
  - **불변성(immutability)**
    - 어떤 값이 변하지 않는 성질
- 참조 투명성의 장점
  - 모든 함수를 이미 알고 있는 하나의 결괏값으로 대체할 수 있다.
    - 식을 쉽게 계산할 수 있다.
  - 모든 곳에서 함수의 결괏값이 동일하다.
    - 식의 순서를 변경하더라도 각 식의 결과는 달라지지 않는다.
- 명령형 프로그래밍
  - 부수효과를 기반으로 하는 프로그래밍 방식
- 함수형 프로그래밍
  - 부수효과가 존재하지 않는 수학적인 함수에 기반한 프로그래밍 방식

## 책임에 초점을 맞춰라
- 디미터 법칙을 준수하고 묻지 말고 시켜라 스타일을 따르면서도 의도를 드러내는 인터페이스를 설계하는 방법
  - 메시지를 먼저 선택하고 그 후에 메시지를 처리할 객체를 선택하는 것이다.
- 명령과 쿼리를 분리하고 계약에 의한 설계 개념을 통해 객체의 협력 방식을 명시적으로 드러낼 수 있는 방법
  - 객체의 구현 이전에 객체 사이의 협력에 초점을 맞추고 협력 방식을 단순하고 유연하게 만드는 것
- 메시지를 먼저 선택하는 방식이 디미터 법칙, 묻지 말고 시켜라 스타일, 의도를 드러내는 인터페이스, 명령-쿼리 분리 원칙에 미치는 긍정적인 영향
  - 디미터 법칙
    - 협력이라는 컨텍스트 안에서 객체보다 메시지를 먼저 결정
      - 두 객체 사이의 구조적인 결합도를 낮출 수 있다.
    - 수신할 객체를 알지 못한 상태에서 메시지를 먼저 선택
      - 객체의 내부 구조에 대해 고민할 필요가 없어진다.
  - 묻지 말고 시켜라
    - 메시지를 먼저 선택
      - 묻지 말고 시켜라 스타일에 따라 협력을 구조화
    - 클라이언트 관점에서 메시지를 선택
      - 필요한 정보를 물을 필요 없이 원하는 것을 표현한 메시지를 전송
  - 의도를 드러내는 인터페이스
    - 메시지를 먼저 선택
      - 메시지를 전송하는 클라이언트 관점에서 메시지의 이름을 정한다는 것
  - 명령-쿼리 분리 원칙
    - 메시지를 먼저 선택
      - 협력이라는 문맥 안에서 객체의 인터페이스에 관해 고민한다는 것
    - 객체가 단순히 어떤 일을 해야 하는지뿐만 아니라 협력 속에서 객체의 상태를 예측하고 이해하기 쉽게 만들기 위한 방법에 관해 고민
      - 예측 가능한 협력을 만들기 위해 명령과 쿼리를 분리
- 훌륭한 메시지를 얻기 위한 출발점
  - 책임 주도 설계 원칙을 따르는 것
- 객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택
  - 협력에 적합한 메시지를 결정할 수 있는 확률이 높아짐
- 지금까지 살펴본 원칙들
  - 실제로 실행 시점에 필요한 구체적인 제약이나 조건을 명확하게 표현하지 못한다.
  - 두 객체가 보장해야 하는 실행 시점의 제약을 인터페이스에 명시할 수 있는 방법이 존재하지 않는다.
- 계약에 의한 설계(Design By Contract)
  - 협력을 위해 클라이언트와 서버가 준수해야 하는 제역을 코드 상에 명시적으로 표현하고 강제할 수 있는 방법
